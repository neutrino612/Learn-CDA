加强版本的数据透视工具，在数据处理上，透视规则上，以及自定义规则上也得到了大幅改善

搭建多维数据分析环境
突破数据行数限制
简洁的操作界面功能
强大的自定义功能


1、power pivot概述及导入数据
选项——加载到——COM加载项——power pivot——————一个设计工具，为透视表服务的
1-1、导入数据，打开power pivot，数据模型——管理——获取外部数据——从其他源（csv文本文件）
1-2、导入power query的数据，加载到——将此数据添加到数据模型中
1-3、本身Excel的数据文件，通过添加到数据模型，也可以导入到power pivot中去

2、搭建多维数据分析模型
2-1、多维数据模型：多维数据集。立方体：相互间通过某种联系被关联在一起的不同类别的数据集合
立方体  cube ，从多角度用数据全面映射某种业务的实际状况

2-2、搭建多维数据集
（1）明确表与表之间用于匹配的关键字段
（2）在关系图视图模式下选中某个表的关键字段拖拽向另一个表的关键字段
注意：
（1）用于连接两表的两个关键字段中，至少有一个关键字段是没有重复值的
（2）关键字段中有重复值的表为主表，没有重复值的表为附表，
重要：：：：在数据透视表中，只有当行列标签来自附表时，附表才能提供字段值
（3）两表关联时必然有一个主表和一个附表，如果两个关键字段都没有重复值，连接时先选中的表为主表

2-3、实例：将多张表关联
(1)导入，然后有两种视图，（1）数据视图（2）关系图视图
(2)在关系图视图中，创建连接    *号代表主表有重复值，1代表附表
(3)在主页——数据透视表——新工作表，左侧多了不同数据源的表

3、创建层次结构
3-1、方法：
（1）关系图视图下，选中父级字段后鼠标右键选中“创建层次结构关系”
（2）为层次结构命名
（3）将子级字段拖拽到创建好的 层次结构中父级字段的下方

创建层次结构时   一定要符合业务逻辑

3-2、DAX表达式
power pivot 特有函数集
（1）DAX表达式的结果应用在数据透视表中
（2）DAX表达式的结果作用于整列或者表中所有行
（3）还需注意：
    表名用“‘’“引用
    字段名（列名）用[]引用
    要注意函数表达式中参数的数据类型，尤其是要将表和数值正确区分
    与Excel公式相同，除了直接在编辑器的公式区域输入公式外还可以通过单击公式编辑栏前的fx图标启动插入函数对话框，在对话框中选择需要的函数使用
    表达式中的函数名不分大小写，比如ALL函数也可以记作all


3-2-1、案例：数据透视表中进行复杂观测，就用到DAX表达式了
switch 函数可以将数值描述替换为文字描述
related函数合并字段
filter函数，筛选
calculate函数   计算规则

4、使用KPI
KPI：Excel数据透视表当中创建图标集的方法，比如红绿黄三色图标等，可以快速的判断数据的程度
（1）在编辑器下方公式区域内用公式为需要创建KPI的字段指定汇总情况
（2）点击  创建KPI在关键绩效指标KPI对话框中设定KPI规则
（3）定义KPI目标值的方法有“度量值”及“绝对值”两种方法，“度量值”是以两种汇总值之间的百分比为判断依据，
而绝对值是以一个汇总规则与某个绝对数值之间的大小关系为判断依据

筛选器函数ALL   用来返回计算汇总值得数据范围
组合使用calculate(average('表'[销售金额]，all（‘表1’[城市]）))
计算 销售金额的平均数，条件是所有的城市
备注：创建KPI有基础值和度量值   选中基础值，选择创建KPI，阈值可以调整




1、power query概述以及多源数据导入

提取整合多数据源数据、
突破Excel数据限制、
数据分析功能、
M函数灵活创建自定义数据处理及计算规则、
***创建好的数据处理流程可以无限次利用 提效

power query  在Excel的  数据-获取和转换
包含四个选项卡
【主页】
【转换】
【添加列】
【视图】

2-1导入文件类型用记事本打开可以看到“xlsx  accdb  txt(分隔符 tab)  csv(分隔符，逗号)
从数据库导入---进入导航器--加载（加载、加载到表和仅创建连接）

2-2点击左侧已经加载的文件————进入查询编辑器；或者直接转换数据进入编辑器

3、power query合并数据

表结构数据的数据结构
字段包含标题行即字段名+相应字段名下的XX行记录；数据表和数据库（数据表的集合）

3-1合并之横向合并：（1）确定关键字段（即都有的公共字段）（2）合并操作（3）选择所需要的字段信息
将副表中的信息合并到主表中去
备注：当关键字段有重复值，主表中2次；副表中2次，合并后为2*2=4次

3-1-1  实例操作：区分主副表；选中主表；主页选项卡——合并查询——选择主表和副表的关键字段后，确定——
链接种类：内部

3-1-2 链接种类：左外部即主表全部记录都在，副表尽量匹配，缺失则为空值


3-2合并之纵向合并：（1）将有相同的字段名的字段纵向合并到一起（2）将不同字段名的字段追加在最后（3）非匹配字段标记为null值

备注：如果字段名的格式和记录一样，在导入事，Excel会自行添加标题行，可以在query中进行处理
主页——转换——架构第一行用作标题
3-2-1  选中表1 ，主页——合并——追加查询

4、power query 基本功能   4个选项卡
4-1、解决错误提示，通过应用步骤的M函数
4-2、填充功能，解决null。转换——填充
4-3、透视列，通过数据统计维度查看
4-4、逆透视列
4-5、添加自定义列   添加列——自定义列


5、M函数精讲
80%通过M函数，
5-1、编辑方法：（1）通过编辑栏，添加自定义列（单行的M函数），或者高级编辑器（复杂函数批处理程序）等功能了解M函数表达式写法
（2）根据需求重新编辑表达式程序
（3）编辑错误通过“查询设置”区域退回重新编辑
（4）在编辑器中输入“=#shared”可以查看M函数列表
要求：会改；会写
身份证倒数第二位   偶数女性；奇数男性

新建查询，在编辑器中输入“=#shared”可以查看M函数列表
选择到表中，就可以将M函数列表转化成表结构数据
可以通过筛选，点击FUNCTION快速选择查看M函数的使用说明，text.函数   table.函数   list.函数

5-2、案例：身份证倒数第二位   偶数女性；奇数男性
（1）添加列——索引列
（2）自定义列，性别 （取第十七位数） 数据类型
（3）转换——编号列——信息——偶数（逻辑值）
问题：逻辑型无法替换成文本型  （4）主页——转换——数据类型——文本
（5）主页——转换——替换值


视图——高级编辑器，可以批量进行M函数的组合
let  in结构
